{"version":3,"sources":["components/Main/Main.js","components/TextContainer/TextContainer.js","components/Join/Join.js","App.js","index.js"],"names":["socket","TextContainer","props","className","users","map","user","key","name","isOffered","onClick","createAnswer","a","startCapture","createOfferToSpecific","id","Main","location","useState","setName","setRoom","setUsers","setMessages","setIsOffered","ENDPOINT","RTCPeerConnection","urls","pc","localVideoref","React","useRef","remoteVideoref","useEffect","queryString","parse","search","room","io","emit","error","alert","on","message","msgs","sdp","type","console","log","JSON","stringify","setRemoteDescription","RTCSessionDescription","candidate","addIceCandidate","RTCIceCandidate","oniceconnectionstatechange","e","ontrack","current","srcObject","streams","controls","onicecandidate","sendToPeer","messageType","payload","socketID","sendOfferToSpecificPeer","target","navigator","mediaDevices","getDisplayMedia","then","stream","localStream","getTracks","forEach","track","addTrack","catch","videoStyle","backgroundColor","height","width","display","margin","style","ref","autoPlay","marginTop","createOffer","offerToReceiveVideo","setLocalDescription","SignIn","generateRoomString","input","document","getElementById","generatedString","replace","c","r","Math","random","toString","value","placeholder","onChange","event","onInput","preventDefault","to","App","path","exact","component","Join","ReactDOM","render"],"mappings":"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","file":"static/js/main.1e587bf7.chunk.js","sourcesContent":["import React, { useState, useEffect} from \"react\";\nimport queryString from \"query-string\";\nimport io from \"socket.io-client\";\nimport adapter from 'webrtc-adapter';\n\nimport TextContainer from \"../TextContainer/TextContainer\";\nimport \"./Main.css\";\n\nlet socket;\n\nconst Main = ({ location }) => {\n  const [name, setName] = useState(\"\");\n  const [room, setRoom] = useState(\"\");\n  const [users, setUsers] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [isOffered, setIsOffered] = useState(false);\n  const ENDPOINT = \"https://vast-shore-37325.herokuapp.com/\";\n  const pc_config = {\"iceServers\": [{urls : 'stun:stun.l.google.com:19302'}]};\n  const [pc, setPC] = useState(new RTCPeerConnection(pc_config))\n\n  let localVideoref = React.useRef();\n  let remoteVideoref = React.useRef();\n\n  useEffect(() => {\n\n    const { name, room } = queryString.parse(location.search);\n    socket = io(ENDPOINT);\n\n    setRoom(room);\n    setName(name);\n\n    socket.emit(\"join\", { name, room }, (error) => {\n      if (error) {\n        alert(error);\n      }\n    });\n  }, [ENDPOINT, location.search]);\n\n  useEffect(() => {\n\n\n    socket.on(\"message\", (message) => {\n      setMessages((msgs) => [...msgs, message]);\n    });\n    socket.on(\"roomData\", ({ users }) => {\n      setUsers(users);\n    });\n\n  }, [])\n\n  useEffect(() => {\n\n    socket.on('offerOrAnswer', (sdp) => {\n      (sdp.type === \"offer\") ? setIsOffered(true) : setIsOffered(false)\n      console.log(\"Offer/Answer \", JSON.stringify(sdp));\n      pc.setRemoteDescription(new RTCSessionDescription(sdp))\n    })\n\n    socket.on('candidate', (candidate) => {\n      console.log(\"candidate - \", candidate)\n      if(candidate){\n      pc.addIceCandidate(new RTCIceCandidate(candidate))\n      }\n    })\n\n    pc.oniceconnectionstatechange = (e) => {\n      console.log(e)\n    }\n\n    pc.ontrack = (e) => {\n      remoteVideoref.current.srcObject = e.streams[0]\n      remoteVideoref.current.controls = true;\n    }\n\n    pc.onicecandidate = (e) => {\n      sendToPeer('candidate', e.candidate); \n    }\n\n  }, [])\n\n  const sendToPeer = (messageType, payload) => {\n    socket.emit(messageType, {\n      socketID: socket.id,\n      payload,\n    });\n  };\n\n  const sendOfferToSpecificPeer = (payload, target) => {\n    socket.emit('OfferToSpecific', {\n      socketID: socket.id,\n      payload,\n      target\n    });\n}\n\n  const createAnswer = () => {\n    console.log('Answer')\n    pc.createAnswer({ offerToReceiveVideo: true})\n      .then(sdp => {\n        console.log(sdp)\n        pc.setLocalDescription(sdp)\n        sendToPeer('offerOrAnswer', sdp)\n      })\n      .then(setIsOffered(false))\n  }\n\n  const createOfferToSpecific = (target) => {\n    console.log('OfferToSpecificPeer')\n    pc.createOffer({ offerToReceiveVideo: true })\n      .then(sdp => {\n        console.log(sdp)\n        pc.setLocalDescription(sdp)\n        sendOfferToSpecificPeer(sdp, target)\n    })\n  }\n\n  const startCapture = async () => {\n     await navigator.mediaDevices\n      .getDisplayMedia()\n      .then((stream) => {\n        //window.localStream = stream;\n        localVideoref.current.srcObject = stream;\n        localVideoref.current.controls = true;\n        let localStream = stream.getTracks();\n        console.log(localStream);\n        localStream.forEach((track) => pc.addTrack(track, stream));\n      })\n      .catch((e) => {\n        console.log(\"getDisplayMedia Error: \", e);\n      })\n      ;\n  };\n\n  const videoStyle = {\n    backgroundColor: 'black',\n    height: \"40%\",\n    width: \"90%\",\n    display: \"table\",\n    margin: \"auto\"\n  }\n\n  return (\n    <div className=\"outerContainer\">\n      <div className=\"container\">\n        <p>Din skärm</p>\n        <video \n          style={videoStyle} ref={localVideoref} autoPlay></video>\n        <button onClick={startCapture} style={{marginTop: \"10px\"}}>Testa bild</button>\n        <hr />\n        <p>Främmande skärm</p>\n        <video\n          style={videoStyle}\n          id=\"remoteVideo\"\n          ref={remoteVideoref}\n          autoPlay\n        ></video>\n        <p></p>\n      </div>\n      <TextContainer users={users} sendOfferToSpecificPeer={sendOfferToSpecificPeer} sendToPeer={sendToPeer} pc={pc} createOfferToSpecific={createOfferToSpecific} createAnswer={createAnswer} name={name} isOffered={isOffered} startCapture={startCapture}/>\n    </div>\n  );\n};\n\nexport default Main;\n","import React from 'react';\n\nimport './TextContainer.css';\n\nconst TextContainer = (props) => (\n  <div className=\"textContainer\">\n    {\n      props.users\n        ? (\n          <div>\n            <h1>People in the room:</h1>\n            <div className=\"activeContainer\">\n              <h2>\n                {props.users.map((user) => (\n                  <div key={user.name} className=\"activeItem\">\n                    <span className=\"spanText\">{user.name}</span>\n                    {props.name === user.name ? \n                    \" (You)\" \n                    : \n                    props.isOffered ? <span>\n                    <button onClick={() => props.createAnswer()}>Acceptera skärmdelning</button>\n                    <button onClick={null}>Neka</button>\n                    </span>:\n                    <button onClick={async () => {\n                      await props.startCapture()\n                      props.createOfferToSpecific(user.id)\n                    }}>Erbjud skärmdelning</button>\n\n                    }\n                  </div>\n                ))}\n              </h2>\n            </div>\n          </div>\n        )\n        : null\n    }\n  </div>\n);\n\nexport default TextContainer;","import React, { useState } from 'react';\nimport { Link } from \"react-router-dom\";\n\n\nimport './Join2.css'\n\n\nexport default function SignIn() {\n  const [name, setName] = useState('');\n  const [room, setRoom] = useState('');\n\n  const generateID = () => {\n    return 'xxxx-xxxx-4xxx-yxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    });\n  }\n\n  const generateRoomString = () => {\n    let input = document.getElementById(\"roomField\")\n    let generatedString = generateID();\n    input.value = generatedString;\n    setRoom(generatedString);\n  }\n\n\n  return (\n  <div>\n    <div>\n        <h1 className=\"heading\">Screen Sharing App</h1>\n        <p>Choose a name and a room</p>\n        <div>\n          <input placeholder=\"Name\" className=\"joinInput\" type=\"text\" onChange={(event) => setName(event.target.value)} />\n        </div>\n        <div>\n          <input id=\"roomField\" placeholder=\"Room\" className=\"joinInput mt-20\" type=\"text\" onInput={(event) => setRoom(event.target.value)} />\n        </div>\n        <button className={'button mt-20'} onClick={(e) => {\n          e.preventDefault();\n          console.log(e);\n          generateRoomString();\n        }}>Generate</button>\n        <Link onClick={e => (!name || !room) ? e.preventDefault() : null} to={`/Main?name=${name}&room=${room}`}>\n          <button className={'button mt-20'} type=\"submit\">Sign In</button>\n        </Link>\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\n\nimport Main from './components/Main/Main';\nimport Join from './components/Join/Join';\n\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\n\nconst App = () => {\n  return (\n    <Router>\n      <Route path=\"/\" exact component={Join} />\n      <Route path=\"/Main\" component={Main} />\n    </Router>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}